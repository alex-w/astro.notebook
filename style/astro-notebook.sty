%%% Русский шрифт
\RequirePackage{style/astro-notebook.russian}


%%% Математика
\RequirePackage{style/astro-notebook.maths}


%%% Поля и разметка страницы
%\RequirePackage[inner=1.5cm, outer=0.9cm, top=1.5cm, bottom=1.2 cm, headsep=4mm]{geometry} % Старая
\RequirePackage[inner=2.0cm, outer=1.5cm, top=2cm, bottom=1.5 cm, headsep=4mm]{geometry} % Новая


%%% Набор текста

% Разрывы страниц в формулах
\allowdisplaybreaks

% Последняя строка абзаца
\widowpenalty10000
\clubpenalty10000

%%% Иллюстрации
\RequirePackage{graphicx}
\RequirePackage{wrapfig}
\RequirePackage[export]{adjustbox}
\graphicspath{{./img/}}

% Графики
\RequirePackage{style/astro-notebook.plot}

%Подписи
\RequirePackage{style/astro-notebook.caption}


%%% Insert pdf pages
\RequirePackage[final]{pdfpages}


%%% Color highlight
\RequirePackage{xcolor}


%%% TiKZ
\RequirePackage{tikz}
\RequirePackage{tkz-euclide}
\RequirePackage{tikz-3dplot}
\RequirePackage{style/tikz-3dplot-circleofsphere}
\RequirePackage{style/plotting}

\usetikzlibrary{external}
\tikzexternalize[prefix=tikz/resource/,optimize command away=\includepdf]
\usetikzlibrary{
    angles,
    calc,
    calligraphy,
    decorations.markings,
    decorations.pathreplacing,
    fadings,
    shapes,
    snakes,
    quotes
}

\input{sys/tikz-commands}

\makeatletter

\tikzset{
    every picture/.style={line cap=round},
% dot diameter/.store in=\dot@diameter,
% dot diameter=3pt,
    dot spacing/.store in=\dot@spacing,
    dot spacing = 4pt,
    dashes/.style={
        %        line width=\dot@diameter,
        line cap=round,
        dash pattern=on 4pt off \dot@spacing
    },
    triple arc/.style={
        double distance=2pt,
        pic actions/.append code=\tikzset{postaction={draw}}
    },
    markII/.style={%
        decoration={% 
            post length=1mm,
            pre length=1mm,
            markings, %
            mark= at position 0.5 with {%
                \draw (-0.5pt,-1.5pt) -- (-0.5pt,1.5pt);
                \draw (0.5pt,-1.5pt) -- (0.5pt,1.5pt);
            }% 
        },%
        pic actions/.append code=\tikzset{postaction=decorate}%
    },
    arrow/.style 2 args={
        postaction=decorate,
        decoration={
            markings, 
            mark=at position #2 with {\arrow{#1}}
        } 
    }
}

\makeatother

%%% Таблицы
\RequirePackage{style/astro-notebook.table}


%%% Нумерованные списки
\RequirePackage{enumitem}
\setlist[enumerate]{itemsep=1pt, label={\arabic*.}, leftmargin=1pc}
\setlist[itemize]{itemsep=1pt, label={$\circ$}, leftmargin=1pc}


%%% Новые команды
\RequirePackage{style/astro-notebook.command}


%%% Cчетчики
\renewcommand{\theequation}{\thesection.\arabic{equation}}
\numberwithin{equation}{section}


%%% Отступы
\setlength {\parskip} { 4pt }
%\setlength {\parindent} { 0pt }
\renewcommand {\baselinestretch}{ 1.02 }


%%% Гиперссылки
\RequirePackage{style/astro-notebook.hyperlink}


%%% Колонтитулы
\RequirePackage{style/astro-notebook.header}


%%% Заголовки
\RequirePackage{titlesec}
\newcommand{\sectionbreak}{\clearpage}


%%% Шрифты
\RequirePackage{style/astro-notebook.font}


%%% Сноски
%\RequirePackage[symbol, perpage]{footmisc}
%\setfnsymbol{wiley}


%%% Bibliograpy
\RequirePackage{style/astro-notebook.bibliography}
